
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pytools.api._api &#8212; pytools  documentation</title>
    
  <link rel="stylesheet" href="../../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/gamma.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/gamma.js"></script>
    <script src="../../../_static/js/versions.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../../../index.html">
    
      <img src="../../../_static/gamma_pytools_logo.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../../getting_started/getting_started.html">Getting started</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../../apidoc/pytools.html">API reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../../contribution_guide.html">Development Guidelines</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../../faqs.html">FAQ</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../../release_notes.html">Release Notes</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for pytools.api._api</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Core implementation of :mod:`pytools.api`.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Any</span><span class="p">,</span>
    <span class="n">Callable</span><span class="p">,</span>
    <span class="n">Collection</span><span class="p">,</span>
    <span class="n">Dict</span><span class="p">,</span>
    <span class="n">Iterable</span><span class="p">,</span>
    <span class="n">List</span><span class="p">,</span>
    <span class="n">Optional</span><span class="p">,</span>
    <span class="n">Set</span><span class="p">,</span>
    <span class="n">Tuple</span><span class="p">,</span>
    <span class="n">Type</span><span class="p">,</span>
    <span class="n">TypeVar</span><span class="p">,</span>
    <span class="n">Union</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">typing_inspect</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;AllTracker&quot;</span><span class="p">,</span>
    <span class="s2">&quot;is_list_like&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_tuple&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_list&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_set&quot;</span><span class="p">,</span>
    <span class="s2">&quot;validate_type&quot;</span><span class="p">,</span>
    <span class="s2">&quot;validate_element_types&quot;</span><span class="p">,</span>
    <span class="s2">&quot;get_generic_bases&quot;</span><span class="p">,</span>
    <span class="s2">&quot;public_module_prefix&quot;</span><span class="p">,</span>
    <span class="s2">&quot;deprecated&quot;</span><span class="p">,</span>
    <span class="s2">&quot;deprecation_warning&quot;</span><span class="p">,</span>
    <span class="s2">&quot;inheritdoc&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
<span class="n">T_Collection</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;T_Collection&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">Collection</span><span class="p">)</span>


<div class="viewcode-block" id="AllTracker"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.AllTracker.html#pytools.api.AllTracker">[docs]</a><span class="k">class</span> <span class="nc">AllTracker</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Track global, public items defined in a module and validate that all eligible items</span>
<span class="sd">    have been included in the ``__all__`` variable.</span>

<span class="sd">    Items will be tracked if:</span>

<span class="sd">    - their name does not start with an underscore character</span>
<span class="sd">    - they are defined after the :class:`.AllTracker` instance has been created</span>

<span class="sd">    The underlying idea (and widely used pattern in GAMMA packages) is to define all</span>
<span class="sd">    items in one or more private submodules, export all public items using the</span>
<span class="sd">    ``__all__`` keyword, and import them into a public package one level up</span>
<span class="sd">    (usually the package&#39;s ``__init__.py``).</span>

<span class="sd">    This ensures a clean namespace in the public package, uncluttered by any imports</span>
<span class="sd">    used in the private module.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">globals_</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">public_module</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param globals_: the dictionary of global variables returned by calling</span>
<span class="sd">            :meth:`._globals` in the current module scope</span>
<span class="sd">        :param public_module: full name of the public module that will export the items</span>
<span class="sd">            managed by this tracker</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_globals</span> <span class="o">=</span> <span class="n">globals_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imported</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">globals_</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">public_module</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">public_module</span> <span class="o">=</span> <span class="n">public_module</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">module</span> <span class="o">=</span> <span class="n">globals_</span><span class="p">[</span><span class="s2">&quot;__name__&quot;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;cannot infer public module: &quot;</span>
                    <span class="s2">&quot;arg globals_ does not define module name in __name__&quot;</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">public_module</span> <span class="o">=</span> <span class="n">public_module_prefix</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

    <span class="c1">#: Full name of the public module that will export the items managed by this</span>
    <span class="c1">#: tracker.</span>
    <span class="n">public_module</span><span class="p">:</span> <span class="nb">str</span>

<div class="viewcode-block" id="AllTracker.validate"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.AllTracker.html#pytools.api.AllTracker.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate that all eligible items that were defined since the creation of this</span>
<span class="sd">        tracker are listed in the ``__all__`` variable.</span>

<span class="sd">        :raise RuntimeError: if ``__all__`` is not as expected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_expected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tracked</span><span class="p">()</span>

        <span class="n">globals_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_globals</span>

        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">globals_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;__all__&quot;</span><span class="p">,</span> <span class="p">[]))</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_expected</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;missing or unexpected all declaration, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;expected:</span><span class="se">\n</span><span class="s2">__all__ = </span><span class="si">{</span><span class="n">all_expected</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">public_module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">public_module</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">all_expected</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">globals_</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">__publicmodule__</span> <span class="o">=</span> <span class="n">public_module</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span></div>

<div class="viewcode-block" id="AllTracker.get_tracked"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.AllTracker.html#pytools.api.AllTracker.get_tracked">[docs]</a>    <span class="k">def</span> <span class="nf">get_tracked</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List the names of all locally tracked, public items.</span>

<span class="sd">        :return: the list of object names, sorted alphabetically</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_globals</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_eligible</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">))</span></div>

<div class="viewcode-block" id="AllTracker.is_tracked"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.AllTracker.html#pytools.api.AllTracker.is_tracked">[docs]</a>    <span class="k">def</span> <span class="nf">is_tracked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if the given item is tracked by this tracker under the given name.</span>

<span class="sd">        :param name: the name of the item in the tracker&#39;s global namespace</span>
<span class="sd">        :param item: the item referred to by the name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_globals</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="ow">is</span> <span class="n">item</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_eligible</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

    <span class="k">def</span> <span class="nf">_is_eligible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># check if the given item is eligible for tracking by this tracker</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imported</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="c1"># get a tracked item by name</span>

        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_globals</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_eligible</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>


<span class="c1"># regular expression to extract the public prefix of a private module</span>
<span class="c1"># this is the module path up to the first submodule with a leading underscore</span>
<span class="n">__RE_PUBLIC_MODULE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="c1"># start of match group for the public part of the module path</span>
    <span class="sa">r</span><span class="s2">&quot;(&quot;</span>
    <span class="c1"># first module component must not start with &#39;_&#39;)</span>
    <span class="sa">r</span><span class="s2">&quot;(?:[a-zA-Z]\w+)&quot;</span>
    <span class="c1"># then as many path components as can be matched non-greedily …)</span>
    <span class="sa">r</span><span class="s2">&quot;(?:\.\w+)*?&quot;</span>
    <span class="c1"># but when we hit the first private path component, we stop matching the</span>
    <span class="c1"># public part of the path …</span>
    <span class="sa">r</span><span class="s2">&quot;)&quot;</span>
    <span class="c1"># … and match the rest as the private path</span>
    <span class="sa">r</span><span class="s2">&quot;(?:\._\w*(?:\.\w+)*)?&quot;</span>
<span class="p">)</span>


<div class="viewcode-block" id="public_module_prefix"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.public_module_prefix.html#pytools.api.public_module_prefix">[docs]</a><span class="k">def</span> <span class="nf">public_module_prefix</span><span class="p">(</span><span class="n">module_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the public prefix of the given module name.</span>

<span class="sd">    A module name is composed of one or more identifiers, separated by ``.`` operators.</span>
<span class="sd">    The public prefix is the module name including all identifiers up to, and excluding,</span>
<span class="sd">    the first identifier starting with an underscore character (``_``) .</span>
<span class="sd">    If there is no such identifier, then the public prefix is the same as the full</span>
<span class="sd">    module name.</span>
<span class="sd">    If the first identifier starts with a ``_``, then the public prefix is not defined.</span>

<span class="sd">    For example:</span>

<span class="sd">    - the public module prefix of ``a.b._c.d._e`` is ``a.b``</span>
<span class="sd">    - the public module prefix of ``a.b`` is ``a.b``</span>
<span class="sd">    - the public module prefix of ``_a.b.c`` is undefined</span>

<span class="sd">    :param module_name: the module name for which to get the public prefix</span>
<span class="sd">    :return: the public prefix</span>
<span class="sd">    :raise ValueError: the public prefix is undefined</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">__RE_PUBLIC_MODULE</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cannot infer public module path from module </span><span class="si">{</span><span class="n">module_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>


<span class="c1">#</span>
<span class="c1"># Ensure all symbols introduced below are included in __all__</span>
<span class="c1">#</span>

<span class="n">__tracker</span> <span class="o">=</span> <span class="n">AllTracker</span><span class="p">(</span><span class="nb">globals</span><span class="p">())</span>
<span class="c1"># we forget that class AllTracker itself is already defined, because we want to include</span>
<span class="c1"># it in the __all__ statement</span>
<span class="c1"># noinspection PyProtectedMember</span>
<span class="n">__tracker</span><span class="o">.</span><span class="n">_imported</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">AllTracker</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
<span class="c1"># noinspection PyProtectedMember</span>
<span class="n">__tracker</span><span class="o">.</span><span class="n">_imported</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">public_module_prefix</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Functions</span>
<span class="c1">#</span>


<div class="viewcode-block" id="is_list_like"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.is_list_like.html#pytools.api.is_list_like">[docs]</a><span class="k">def</span> <span class="nf">is_list_like</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the object is list-like.</span>

<span class="sd">    Objects that are considered list-like when they implement methods ``len`` and</span>
<span class="sd">    ``__getitem__``. These include, for example, lists, tuples, sets, NumPy arrays, and</span>
<span class="sd">    Pandas series and indices.</span>

<span class="sd">    As an exception, the following types are not considered list-like:</span>

<span class="sd">    - :class:`str`</span>
<span class="sd">    - :class:`bytes`</span>
<span class="sd">    - :class:`pandas.DataFrame`: inconsistent behaviour of the sequence interface;</span>
<span class="sd">        iterating a data frame yields the values of the column index, while the length</span>
<span class="sd">        of a data frame is its number of rows</span>
<span class="sd">    - :class:`numpy.ndarray` instances with 0 dimensions</span>

<span class="sd">    :param obj: The object to check</span>
<span class="sd">    :return: ``True`` if ``obj`` has list-like properties, ``False`` otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">)</span>
        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;__getitem__&quot;</span><span class="p">)</span>
        <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))</span>
        <span class="c1"># pandas data objects with more than 1 dimension, e.g., data frames</span>
        <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">NDFrame</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># exclude zero-dimensional numpy arrays, effectively scalars</span>
        <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="to_tuple"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.to_tuple.html#pytools.api.to_tuple">[docs]</a><span class="k">def</span> <span class="nf">to_tuple</span><span class="p">(</span>
    <span class="n">values</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">T</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">element_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">arg_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the given values as a tuple.</span>

<span class="sd">    - if arg `values` is a tuple, return arg `values` unchanged</span>
<span class="sd">    - if arg `values` is an iterable other than a tuple, return a list of its elements</span>
<span class="sd">    - if arg `values` is not an iterable, return a tuple with the value as its only</span>
<span class="sd">      element</span>

<span class="sd">    :param values: one or more elements to return as a tuple</span>
<span class="sd">    :param element_type: expected type of the values; raise a ``TypeException`` if one</span>
<span class="sd">        or more values do not implement this type</span>
<span class="sd">    :param arg_name: name of the argument as which the values were passed to a function</span>
<span class="sd">        or method; used when composing the ``TypeException`` message</span>
<span class="sd">    :return: the values as a tuple</span>
<span class="sd">    :raise TypeException: one or more values did not match the expected type</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">_to_collection</span><span class="p">(</span>
        <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
        <span class="n">collection_type</span><span class="o">=</span><span class="nb">tuple</span><span class="p">,</span>
        <span class="n">element_type</span><span class="o">=</span><span class="n">element_type</span><span class="p">,</span>
        <span class="n">arg_name</span><span class="o">=</span><span class="n">arg_name</span><span class="p">,</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="to_list"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.to_list.html#pytools.api.to_list">[docs]</a><span class="k">def</span> <span class="nf">to_list</span><span class="p">(</span>
    <span class="n">values</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">T</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">element_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">arg_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the given values as a list.</span>

<span class="sd">    - if arg `values` is a list, return arg `values` unchanged</span>
<span class="sd">    - if arg `values` is an iterable other than a list, return a list of its elements</span>
<span class="sd">    - if arg `values` is not an iterable, return a list with the value as its only</span>
<span class="sd">      element</span>

<span class="sd">    :param values: one or more elements to return as a list</span>
<span class="sd">    :param element_type: expected type of the values; raise a ``TypeException`` if one</span>
<span class="sd">        or more values do not implement this type</span>
<span class="sd">    :param arg_name: name of the argument as which the values were passed to a function</span>
<span class="sd">        or method; used when composing the ``TypeException`` message</span>
<span class="sd">    :return: the values as a list</span>
<span class="sd">    :raise TypeException: one or more values did not match the expected type</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">_to_collection</span><span class="p">(</span>
        <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
        <span class="n">collection_type</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span>
        <span class="n">element_type</span><span class="o">=</span><span class="n">element_type</span><span class="p">,</span>
        <span class="n">arg_name</span><span class="o">=</span><span class="n">arg_name</span><span class="p">,</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="to_set"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.to_set.html#pytools.api.to_set">[docs]</a><span class="k">def</span> <span class="nf">to_set</span><span class="p">(</span>
    <span class="n">values</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">T</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">element_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">arg_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the given values as a set.</span>

<span class="sd">    - if arg `values` is a set, return arg `values` unchanged</span>
<span class="sd">    - if arg `values` is an iterable other than a set, return a set of its elements</span>
<span class="sd">    - if arg `values` is not an iterable, return a list with the value as its only</span>
<span class="sd">      element</span>

<span class="sd">    :param values: one or more elements to return as a set</span>
<span class="sd">    :param element_type: expected type of the values; raise a ``TypeException`` if one</span>
<span class="sd">        or more values do not implement this type</span>
<span class="sd">    :param arg_name: name of the argument as which the values were passed to a function</span>
<span class="sd">        or method; used when composing the ``TypeException`` message</span>
<span class="sd">    :return: the values as a set</span>
<span class="sd">    :raise TypeException: one or more values did not match the expected type</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">_to_collection</span><span class="p">(</span>
        <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">collection_type</span><span class="o">=</span><span class="nb">set</span><span class="p">,</span> <span class="n">element_type</span><span class="o">=</span><span class="n">element_type</span><span class="p">,</span> <span class="n">arg_name</span><span class="o">=</span><span class="n">arg_name</span>
    <span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_to_collection</span><span class="p">(</span>
    <span class="n">values</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">T</span><span class="p">]],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">collection_type</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T_Collection</span><span class="p">],</span>
    <span class="n">element_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]],</span>
    <span class="n">arg_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Collection</span><span class="p">:</span>

    <span class="n">elements</span><span class="p">:</span> <span class="n">T_Collection</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span>
        <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">collection_type</span><span class="p">):</span>
            <span class="c1"># no change needed, values already is the collection we need</span>
            <span class="n">elements</span> <span class="o">=</span> <span class="n">values</span>
        <span class="k">elif</span> <span class="n">element_type</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">element_type</span><span class="p">):</span>
            <span class="c1"># create a single-element collection</span>
            <span class="n">elements</span> <span class="o">=</span> <span class="n">collection_type</span><span class="p">((</span><span class="n">values</span><span class="p">,))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">elements</span> <span class="o">=</span> <span class="n">collection_type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># create a single-element collection</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">collection_type</span><span class="p">((</span><span class="n">values</span><span class="p">,))</span>

    <span class="k">if</span> <span class="n">element_type</span><span class="p">:</span>
        <span class="n">validate_element_types</span><span class="p">(</span>
            <span class="n">elements</span><span class="p">,</span> <span class="n">expected_type</span><span class="o">=</span><span class="n">element_type</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;arg </span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">elements</span>


<div class="viewcode-block" id="validate_type"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.validate_type.html#pytools.api.validate_type">[docs]</a><span class="k">def</span> <span class="nf">validate_type</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">expected_type</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
    <span class="n">optional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validate that a value implements the expected type.</span>

<span class="sd">    :param value: an arbitrary object</span>
<span class="sd">    :param expected_type: the type to check for</span>
<span class="sd">    :param optional: if ``True``, accept ``None`` as a valid value (default: ``False``)</span>
<span class="sd">    :param name: optional name of the argument or callable with/to which the value</span>
<span class="sd">        was passed; use ``&quot;arg …&quot;`` for arguments, or the name of a callable if</span>
<span class="sd">        verifying positional arguments</span>
<span class="sd">    :raise TypeException: the value did not match the expected type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">expected_type</span> <span class="o">==</span> <span class="nb">object</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">optional</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">expected_type</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">message_head</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> requires&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">message_head</span> <span class="o">=</span> <span class="s2">&quot;expected&quot;</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message_head</span><span class="si">}</span><span class="s2"> instance of </span><span class="si">{</span><span class="n">expected_type</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;but got a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="validate_element_types"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.validate_element_types.html#pytools.api.validate_element_types">[docs]</a><span class="k">def</span> <span class="nf">validate_element_types</span><span class="p">(</span>
    <span class="n">iterable</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">expected_type</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validate that all elements in the given iterable implement the expected type.</span>

<span class="sd">    :param iterable: an iterable</span>
<span class="sd">    :param expected_type: the type to check for</span>
<span class="sd">    :param name: optional name of the argument or callable with/to which the elements</span>
<span class="sd">        were passed; use ``&quot;arg …&quot;`` for arguments, or the name of a callable if</span>
<span class="sd">        verifying positional arguments</span>
<span class="sd">    :raise TypeException: one or more elements of the iterable did not match the</span>
<span class="sd">        expected type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">expected_type</span> <span class="o">==</span> <span class="nb">object</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">iterable</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">expected_type</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">message_head</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> requires&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">message_head</span> <span class="o">=</span> <span class="s2">&quot;expected&quot;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message_head</span><span class="si">}</span><span class="s2"> instances of </span><span class="si">{</span><span class="n">expected_type</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;but got a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="get_generic_bases"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.get_generic_bases.html#pytools.api.get_generic_bases">[docs]</a><span class="k">def</span> <span class="nf">get_generic_bases</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">type</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bugfix version of :func:`typing_inspect.get_generic_bases`.</span>

<span class="sd">    Prevents getting the generic bases of the parent class if not defined for the given</span>
<span class="sd">    class.</span>

<span class="sd">    :param cls: class to get the generic bases for</span>
<span class="sd">    :return: the generic base classes of the given class</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bases</span> <span class="o">=</span> <span class="n">typing_inspect</span><span class="o">.</span><span class="n">get_generic_bases</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bases</span> <span class="ow">is</span> <span class="n">typing_inspect</span><span class="o">.</span><span class="n">get_generic_bases</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)):</span>
        <span class="k">return</span> <span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bases</span></div>


<span class="c1">#</span>
<span class="c1"># Decorators</span>
<span class="c1">#</span>


<div class="viewcode-block" id="deprecated"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.deprecated.html#pytools.api.deprecated">[docs]</a><span class="k">def</span> <span class="nf">deprecated</span><span class="p">(</span><span class="n">function</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decorator to mark a function as deprecated.</span>

<span class="sd">    Logs a warning when the decorated function is called.</span>

<span class="sd">    To deprecate classes, apply this decorator to the ``__init__`` method, not to the</span>
<span class="sd">    class itself.</span>

<span class="sd">    :param function: the function to be decorated</span>
<span class="sd">    :param message: custom message to include when logging the warning (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_deprecated_inner</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">callable</span><span class="p">:</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">new_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Function wrapper</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">message_header</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Call to deprecated </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__qualname__</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message_header</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message_header</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">new_func</span>

    <span class="k">if</span> <span class="n">function</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_deprecated_inner</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">function</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_deprecated_inner</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Deprecation message not provided as a keyword argument. &quot;</span>
            <span class="sa">f</span><span class="s1">&#39;Usage: @</span><span class="si">{</span><span class="n">deprecated</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">(message=&quot;...&quot;)&#39;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Deprecated object must be callable&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="deprecation_warning"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.deprecation_warning.html#pytools.api.deprecation_warning">[docs]</a><span class="k">def</span> <span class="nf">deprecation_warning</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stacklevel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Issue a deprecation warning.</span>

<span class="sd">    :param message: the warning message</span>
<span class="sd">    :param stacklevel: stack level relative to caller for emitting the context of the</span>
<span class="sd">        warning (default: 1)</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">stacklevel</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;arg stacklevel=</span><span class="si">{</span><span class="n">stacklevel</span><span class="si">}</span><span class="s2"> must be a positive integer&quot;</span><span class="p">)</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="n">stacklevel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></div>


<span class="c1"># noinspection PyIncorrectDocstring</span>
<div class="viewcode-block" id="inheritdoc"><a class="viewcode-back" href="../../../apidoc/pytools/api/pytools.api.inheritdoc.html#pytools.api.inheritdoc">[docs]</a><span class="k">def</span> <span class="nf">inheritdoc</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">match</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">type</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">type</span><span class="p">],</span> <span class="nb">type</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decorator to inherit docstrings of overridden methods.</span>

<span class="sd">    Usage:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">      class A:</span>
<span class="sd">          def my_function(self) -&gt; None:</span>
<span class="sd">          \&quot;&quot;&quot;</span><span class="n">Some</span> <span class="n">documentation</span>\<span class="s2">&quot;&quot;&quot;</span>
<span class="s2">          # …</span>

<span class="s2">      @inheritdoc(match=&quot;[see superclass]&quot;)</span>
<span class="s2">      class B(A):</span>
<span class="s2">          def my_function(self) -&gt; None:</span>
<span class="s2">          </span><span class="se">\&quot;</span><span class="s2">&quot;&quot;[see superclass]</span><span class="se">\&quot;</span><span class="s2">&quot;&quot;</span>
<span class="s2">          # …</span>

<span class="s2">          def my_other_function(self) -&gt; None:</span>
<span class="s2">          </span><span class="se">\&quot;</span><span class="s2">&quot;&quot;This docstring will not be replaced</span><span class="se">\&quot;</span><span class="s2">&quot;&quot;</span>
<span class="s2">          # …</span>

<span class="s2">    In this example, the docstring of the ``my_function`` will be replaced with the</span>
<span class="s2">    docstring of the overridden function of the same name, or with ``None`` if no</span>
<span class="s2">    overridden function exists, or if that function has no docstring.</span>

<span class="s2">    :param match: the parent docstring will be inherited if the current docstring</span>
<span class="s2">        is equal to match</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_inheritdoc_inner</span><span class="p">(</span><span class="n">_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">_cls</span><span class="p">):</span>
            <span class="n">_raise_type_error</span><span class="p">(</span><span class="n">_cls</span><span class="p">)</span>

        <span class="n">match_found</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">def</span> <span class="nf">_get_docstring</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="vm">__func__</span><span class="o">.</span><span class="vm">__doc__</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="vm">__doc__</span>

        <span class="k">def</span> <span class="nf">_set_docstring</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">m</span><span class="o">.</span><span class="vm">__func__</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">d</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">m</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">d</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="n">_cls</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">_get_docstring</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">member</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">doc</span> <span class="o">==</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">parents</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmro</span><span class="p">(</span><span class="n">_cls</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="n">_set_docstring</span><span class="p">(</span>
                    <span class="n">m</span><span class="o">=</span><span class="n">member</span><span class="p">,</span>
                    <span class="n">d</span><span class="o">=</span><span class="p">(</span>
                        <span class="n">_get_docstring</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">parents</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                        <span class="k">if</span> <span class="n">parents</span>
                        <span class="k">else</span> <span class="kc">None</span>
                    <span class="p">),</span>
                <span class="p">)</span>
                <span class="n">match_found</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">match_found</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">inheritdoc</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;no match found for docstring </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">match</span><span class="p">)</span><span class="si">}</span><span class="s2"> in class </span><span class="si">{</span><span class="n">_cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">_cls</span>

    <span class="k">def</span> <span class="nf">_raise_type_error</span><span class="p">(</span><span class="n">_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;@</span><span class="si">{</span><span class="n">inheritdoc</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> can only decorate classes, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;not a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">_cls</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">cls</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_inheritdoc_inner</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_inheritdoc_inner</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;arg match not provided as a keyword argument. &quot;</span>
            <span class="sa">f</span><span class="s1">&#39;Usage: @</span><span class="si">{</span><span class="n">inheritdoc</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">(match=&quot;...&quot;)&#39;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_raise_type_error</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span></div>


<span class="n">__tracker</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
</pre></div>

              </div>
              
              
              <div class='prev-next-bottom'>
                

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../../_static/js/index.d3f166471bb80abb5163.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2021, Boston Consulting Group (BCG).<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.4.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>